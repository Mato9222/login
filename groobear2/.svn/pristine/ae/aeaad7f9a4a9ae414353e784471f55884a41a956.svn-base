<%@page import="java.util.List"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@taglib uri="http://www.springframework.org/security/tags"  prefix="security"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
      <style>
        .link-container {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 800px; /* 최대 너비를 설정하여 중앙에 배치 */
            margin: 0 auto; /* 가운데 정렬 */
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .link-column {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            width: 48%;
        }
        .link-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px; /* 패딩을 더 넓게 설정 */
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fff;
        }
        .link-item a {
            color: gray;
            text-decoration: none;
            font-weight: bold;
        }
        .link-item a:hover {
            color: blue;
        }
    </style>
						<!--begin::Content wrapper-->
						<div class="d-flex flex-column flex-column-fluid">
							<security:authentication property="principal.realUser" var="user"/>
							<!--begin::Toolbar-->
							<div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
								<!--begin::Toolbar container-->
								<div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
									<!--begin::Page title-->
									<div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
										<!--begin::Title-->
										<h1 class="page-heading d-flex text-gray-900 fw-bold fs-3 flex-column justify-content-center my-0">프로젝트 정보</h1>
										<!--end::Title-->
										<!--begin::Breadcrumb-->
										<ul class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
											<!--begin::Item-->
											<li class="breadcrumb-item text-muted">
												<a href="index.html" class="text-muted text-hover-primary">메인</a>
											</li>
											<!--end::Item-->
											<!--begin::Item-->
											<li class="breadcrumb-item">
												<span class="bullet bg-gray-500 w-5px h-2px"></span>
											</li>
											<!--end::Item-->
											<!--begin::Item-->
											<li class="breadcrumb-item text-muted">프로젝트</li>
											<!--end::Item-->
											<li class="breadcrumb-item">
												<span class="bullet bg-gray-500 w-5px h-2px"></span>
											</li>
											<li class="breadcrumb-item text-muted">프로젝트 정보</li>
										</ul>
										<!--end::Breadcrumb-->
									</div>
									<!--end::Page title-->
								</div>
								<!--end::Toolbar container-->
							</div>
							<!--end::Toolbar-->
							<!--begin::Content-->
							<div id="kt_app_content" class="app-content flex-column-fluid">
								<!--begin::Content container-->
								<div id="kt_app_content_container" class="app-container container-xxl">
									<!--begin::Navbar-->
									<div class="card mb-6 mb-xl-9">
										<div class="card-body pt-9 pb-0">
											<!--begin::Details-->
											<div class="d-flex flex-wrap flex-sm-nowrap mb-6">
												<!--begin::Image-->
												<div class="d-flex flex-center flex-shrink-0 bg-light rounded w-100px h-100px w-lg-150px h-lg-150px me-7 mb-4">
													<img src="${pageContext.request.contextPath}/resources/demo1/assets/media/logos/logo.png" alt="image" class="p-3" style="width:150px; height:150px;"/>
												</div>
												<!--end::Image-->
												<!--begin::Wrapper-->
												<div class="flex-grow-1">
													<!--begin::Head-->
													<div class="d-flex justify-content-between align-items-start flex-wrap mb-2">
														<!--begin::Details-->
														<div class="d-flex flex-column">
															<!--begin::Status-->
															<div class="d-flex align-items-center mb-1">
																<span class="text-gray-800 text-hover-primary fs-2 fw-bold me-3">${detailList[0].prjctNm}</span>
																<span class="badge badge-light-success me-auto">In Progress</span>
															</div>
															<!--end::Status-->
															<!--begin::Description-->
															<div class="d-flex flex-wrap fw-semibold mb-4 fs-5 text-gray-500">${detailList[0].prjctDc}</div>
															<!--end::Description-->
														</div>
														<!--end::Details-->
													</div>
													<!--end::Head-->
													<!--begin::Info-->
													<div class="d-flex flex-wrap justify-content-start">
														<!--begin::Stats-->
														<div class="d-flex flex-wrap">
															<!--begin::Stat-->
															<div class="border border-gray-300 border-dashed rounded min-w-125px py-3 px-4 me-6 mb-3">
																<!--begin::Number-->
																<div class="d-flex align-items-center">
																	<div class="fs-4 fw-bold">${detailList[0].prjctBgnde}</div>
																</div>
																<!--end::Number-->
																<!--begin::Label-->
																<div class="fw-semibold fs-6 text-gray-500">프로젝트 시작일</div>
																<!--end::Label-->
															</div>
															<!--end::Stat-->
															<!--begin::Stat-->
															<div class="border border-gray-300 border-dashed rounded min-w-125px py-3 px-4 me-6 mb-3">
																<!--begin::Number-->
																<div class="d-flex align-items-center">
																	<i class="ki-duotone ki-arrow-down fs-3 text-danger me-2">
																		<span class="path1"></span>
																		<span class="path2"></span>
																	</i>
																	<div class="fs-4 fw-bold" data-kt-countup="true" data-kt-countup-value="75">${detailList[0].prjctClosOn}</div>
																</div>
																<!--end::Number-->
																<!--begin::Label-->
																<div class="fw-semibold fs-6 text-gray-500">프로젝트 종료일</div>
																<!--end::Label-->
															</div>
															<!--end::Stat-->
															<!--begin::Stat-->
															<div class="border border-gray-300 border-dashed rounded min-w-125px py-3 px-4 me-6 mb-3">
																<!--begin::Number-->
																<div class="d-flex align-items-center">
																	<i class="ki-duotone ki-arrow-up fs-3 text-success me-2">
																		<span class="path1"></span>
																		<span class="path2"></span>
																	</i>
																	<div class="fs-4 fw-bold" data-kt-countup="true" data-kt-countup-value="15000" data-kt-countup-prefix="$">0</div>
																</div>
																<!--end::Number-->
																<!--begin::Label-->
																<div class="fw-semibold fs-6 text-gray-500">작업 예산</div>
																<!--end::Label-->
															</div>
															<!--end::Stat-->
														</div>
														<!--end::Stats-->
														<!--begin::Users-->
														<div class="symbol-group symbol-hover mb-3">
															<!--begin::User-->
															<c:forEach items="${detailList}" var="dl">
																<c:forEach items="${dl.pjMemberVO}" var="pvo">
																	<div class="symbol symbol-35px symbol-circle" data-bs-toggle="tooltip" title="${pvo.empVO.emplNm}">
																		<img src="${pageContext.request.contextPath}/resources/image/${pvo.empVO.proflPhotoCours}">
																	</div>
																</c:forEach>
															</c:forEach>
															<!--end::User-->
														</div>
														<!--end::Users-->
													</div>
													<!--end::Info-->
												</div>
												<!--end::Wrapper-->
											</div>
											<!--end::Details-->
											<div class="separator"></div>
											<!--begin::Nav-->
											<ul class="nav nav-stretch nav-line-tabs nav-line-tabs-2x border-transparent fs-5 fw-bold">
												<li class="nav-item">
													<a class="nav-link active" data-bs-toggle="tab" href="#kt_tab_pane_1">프로젝트 개요</a>
												</li>
												<li class="nav-item">
													<a class="nav-link" data-bs-toggle="tab" href="#kt_tab_pane_2">작업내역</a>
												</li>
												<li class="nav-item">
													<a class="nav-link" data-bs-toggle="tab" href="#kt_tab_pane_3">일감</a>
												</li>
												<li class="nav-item">
													<a class="nav-link" data-bs-toggle="tab" href="#kt_tab_pane_4">Gantt 차트</a>
												</li>
												<li class="nav-item">
													<a class="nav-link" data-bs-toggle="tab" href="#kt_tab_pane_5">파일</a>
												</li>
												<li class="nav-item">
													<a class="nav-link" data-bs-toggle="tab" href="#kt_tab_pane_6">게시판</a>
												</li>
												<li class="nav-item">
													<a class="nav-link" data-bs-toggle="tab" href="#kt_tab_pane_7">설정</a>
												</li>
											</ul>
											<!--end::Nav-->
										</div>
									</div>
									<!--end::Navbar-->
									<!-- tab 컨텐트 -->
									<div class="tab-content" id="myTabContent">
									<!--프로젝트 개요 tab-->
										<div class="tab-pane fade show active" id="kt_tab_pane_1" role="tabpanel">
											<div class="row gx-6 gx-xl-9">
												<!--begin::Col-->
												<div class="col-lg-6">
												    <!--begin::Summary-->
												    <div class="card card-flush h-lg-100">
												        <!--begin::Card header-->
												        <div class="card-header mt-6">
												            <!--begin::Card title-->
												            <div class="card-title flex-column">
												                <h3 class="fw-bold mb-1">일감 진행 현황</h3>
												                <div class="fs-6 fw-semibold text-gray-500">프로젝트 일감 전체 진행 현황</div>
												            </div>
												            <!--end::Card title-->
												            <!--begin::Card toolbar-->
												            <div class="card-toolbar">
												                <a href="#kt_tab_pane_3" class="btn btn-light btn-sm">일감 보기</a>
												            </div>
												            <!--end::Card toolbar-->
												        </div>
												        <!--end::Card header-->
												        <!--begin::Card body-->
												        <div class="card-body p-9 pt-5">
												            <!--begin::Wrapper-->
												            <div class="d-flex flex-wrap">
												                <!--begin::Chart-->
												                <div class="position-relative d-flex flex-center h-100 w-100 mb-7">
												                    <canvas id="kt_chartjs_1" class="w-100 h-100"></canvas>
												                </div>
												                <!--end::Chart-->
												            </div>
												            <!--end::Wrapper-->
												        </div>
												        <!--end::Card body-->
												    </div>
												    <!--end::Summary-->
												</div>
												<!--end::Col-->
												<!--begin::Col-->
													<div class="col-lg-6">
													    <!--begin::Graph-->
													    <div class="card card-flush h-lg-100">
													        <!--begin::Card header-->
													        <div class="card-header mt-6">
													            <!--begin::Card title-->
													            <div class="card-title flex-column">
													                <h3 class="fw-bold mb-1">구성 팀원 소개</h3>
													                <div class="fs-6 fw-semibold text-gray-500">프로젝트 구성원 소개</div>
													            </div>
													            <!--end::Card title-->
													        </div>
													        <!--end::Card header-->
													        <!--begin::Card body-->
													        <div class="card-body pt-10 pb-0 px-5">
													            <!--begin::Table Container-->
													            <div id="kt_project_overview_graph" class="card-rounded-bottom" style="max-height: 300px; overflow-y: auto;">
													                <table class="table align-middle table-row-dashed fs-6 gy-5">
													                    <thead>
													                        <tr class="text-start text-muted fw-bold fs-7 text-uppercase gs-0">
													                            <th class="min-w-50px"></th>
													                            <th class="min-w-75px">이름</th>
													                            <th class="min-w-75px">역할</th>
													                            <th class="min-w-75px">직책</th>
													                        </tr>
													                    </thead>
													                    <tbody class="text-gray-600 fw-semibold">
													                        <c:forEach items="${detailList}" var="dl">
													                            <c:forEach items="${dl.pjMemberVO}" var="pvo">
													                                <tr class="text-start text-muted fw-bold fs-7 text-uppercase gs-0">
													                                    <td>
													                                        <div class="symbol symbol-circle symbol-50px">
													                                            <img src="${pageContext.request.contextPath}/resources/image/${pvo.empVO.proflPhotoCours}" alt="Profile Photo">
													                                        </div>
													                                    </td>
													                                    <td class="emplNm">${pvo.empVO.emplNm}</td>
													                                    <td>${pvo.prjctRoleCodeNm}</td>
													                                    <td>${pvo.empVO.rspofcCodeNm}</td>
													                                </tr>
													                            </c:forEach>
													                        </c:forEach>
													                    </tbody>
													                </table>
													            </div>
													            <!--end::Table Container-->
													        </div>
													        <!--end::Card body-->
													    </div>
													    <!--end::Graph-->
													</div>
												<!--end::Col-->
												<!--begin::Col-->
												<div class="col-lg-6">
													<!--begin::Card-->
													<div class="card card-flush h-lg-100">
														<!--begin::Card header-->
														<div class="card-header mt-6">
															<!--begin::Card title-->
															<div class="card-title flex-column">
																<h3 class="fw-bold mb-1">팀원별 주간 일감 진행 현황</h3>
																<div class="fs-6 text-gray-500">주간별 진행도</div>
															</div>
															<!--end::Card title-->
														</div>
														<!--end::Card header-->
														<!--팀원별 주간 일감 진행 현황 표시작-->
														<div class="card-body p-9 pt-4">
															<div class="card card-bordered">
														    	<div class="card-body">
														        	<div id="kt_apexcharts_1" style="height: 350px;"></div>
														    	</div>
															</div>
														</div>
														<!--팀원별 주간 일감 진행 현황 표끝-->
														<!--end::Card body-->
													</div>
													<!--end::Card-->
												</div>
												<!--end::Col-->
												<!--begin::Col-->
												<div class="col-lg-6">
													<!--begin::Card-->
													<div class="card card-flush h-lg-100">
														<!--begin::Card header-->
														<div class="card-header mt-6">
															<!--begin::Card title-->
															<div class="card-title flex-column">
																<h3 class="fw-bold mb-1">프로젝트 일정</h3>
																<div class="fs-6 fw-semibold text-gray-500">일정 등록 및 조회</div>
															</div>
															<div class="card-body p-9 pt-4">
																<div id="kt_docs_fullcalendar_selectable"></div>
															</div>
															<!--end::Card title-->
														</div>
														<!--end::Card header-->
													</div>
													<!--end::Card-->
												</div>
											</div>
										</div>
										<!--프로젝트 개요 tab 끝-->
										<!-- 작업내역 tab 시작 -->
										<div class="tab-pane fade" id="kt_tab_pane_2" role="tabpanel">
											<div class="card card-p-0 card-flush">
													<div class="card-title flex-column">
														<h3 class="fw-bold mb-1">작업 내역</h3>
														<div class="fs-6 text-gray-500">프로젝트 내 구성원 작업 내역</div>
													</div>
												<div class="card-header align-items-center py-5 gap-2 gap-md-5">
													<div class="card-title">
														<!--begin::Search-->
														<div class="d-flex align-items-center position-relative my-1">
															<i class="ki-duotone ki-magnifier fs-3 position-absolute ms-5">
																	 <span class="path1"></span>
																	 <span class="path2"></span>
															</i>
															<input type="text" data-kt-filter="search" class="form-control form-control-solid w-250px ps-14" placeholder="작업내역 검색" />
														</div>
														<!--end::Search-->
														<!--begin::Export buttons-->
														<div id="kt_datatable_example_1_export" class="d-none"></div>
														<!--end::Export buttons-->
													</div>
													<div class="card-toolbar flex-row-fluid justify-content-end gap-5">
														<!--begin::Export dropdown-->
														<button type="button" class="btn btn-light-primary" data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
															<i class="ki-duotone ki-exit-down fs-2"><span class="path1"></span><span class="path2"></span></i>
															등록
														</button>
														<!--end::Export dropdown-->
											
														<!--begin::Hide default export buttons-->
														<div id="kt_datatable_example_buttons" class="d-none"></div>
														<!--end::Hide default export buttons-->
													</div>
												</div>
												<div class="card-body">
													<table class="table align-middle border rounded table-row-dashed fs-6 g-5" id="kt_datatable_example">
														<thead>
															<!--begin::Table row-->
															<tr class="text-start text-gray-500 fw-bold fs-7 text-uppercase">
																<th class="min-w-75px">Customer Name</th>
																<th class="min-w-75px">Email</th>
																<th class="min-w-50px">Status</th>
																<th class="min-w-75px">Date Joined</th>
																<th class="text-end min-w-75px">No. Orders</th>
																<th class="text-end min-w-75px">No. Products</th>
																<th class="text-end min-w-75px pe-5">Total</th>
															</tr>
															<!--end::Table row-->
														</thead>
														<tbody class="fw-semibold text-gray-600">
															<tr class="odd">
																<td>
																	<a href="#" class="text-gray-900 text-hover-primary">Emma Smith</a>
																</td>
																<td>
																	<a href="#" class="text-gray-900 text-hover-primary">e.smith@kpmg.com.au</a>
																</td>
																<td>
																	<div class="badge badge-light-success">Active</div>
																</td>
																<td data-order="2022-03-10T14:40:00+05:00">10 Mar 2022, 2:40 pm</td>
																<td class="text-end pe-0">94</td>
																<td class="text-end pe-0">103</td>
																<td class="text-end">$500.00</td>
															</tr>
														</tbody>
													</table>
												</div>
											</div>
									</div>
										<!-- 작업내역 tab 끝 -->
										<!-- 일감 tab시작 -->
									<div class="tab-pane fade" id="kt_tab_pane_3" role="tabpanel">
									    <div id="worklist" class="flex-column flex-column-fluid">
									        <!--begin::Toolbar-->
									        <div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
									            <!--begin::Toolbar container-->
									            <div id="kt_app_toolbar_container" class="app-container container-xxl d-flex flex-stack">
									                <!--begin::Page title-->
									                <div class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
									                    <!--begin::Title-->
									                    <h1 class="page-heading d-flex text-gray-900 fw-bold fs-3 flex-column justify-content-center my-0">일감</h1>
									                    <!--end::Title-->
									                </div>
									                <!--end::Page title-->
									            </div>
									            <!--end::Toolbar container-->
									        </div>
									        <!--end::Toolbar-->
									        <!--begin::Content-->
									        <div id="kt_app_content" class="app-content flex-column-fluid">
									            <!--begin::Content container-->
									            <div id="kt_app_content_container" class="app-container container-xxl">
									                <!--begin::Card-->
									                <div class="card">
									                    <!--begin::Card header-->
									                    <div class="card-header border-0 pt-6">
									                        <div class="card-title d-flex justify-content-between w-100">
									                            <!--begin::Search-->
									                            <div class="d-flex align-items-center position-relative my-1">
									                                <i class="ki-duotone ki-magnifier fs-3 position-absolute ms-5">
									                                    <span class="path1"></span>
									                                    <span class="path2"></span>
									                                </i>
									                                    <input type="text" data-kt-subscription-table-filter="search" class="form-control form-control-solid w-250px ps-12 me-3" placeholder="일감 검색" />
									                                    <!--begin::Register button-->
									                                   
									                                    <!--end::Register button-->
									                            </div>
									                             <div>
									                                        <button id="registerButton" type="button" class="btn btn-primary">등록</button>
									                             </div>
									                            <!--end::Search-->
									                        </div>
									                    </div>
									                    <!--end::Card header-->
									                    <!--begin::Card body-->
									                    <div class="card-body pt-0">
									                        <!--begin::Table-->
									                        <table class="table align-middle table-row-dashed fs-6 gy-5" id="kt_subscriptions_table">
									                            <thead>
									                                <tr class="text-start text-muted fw-bold fs-7 text-uppercase gs-0">
									                                    <th class="min-w-50px">#</th>
 									                                    <th class="min-w-50px">일감 상태</th> 
									                                    <th class="min-w-50px">일감 순서</th>
 									                                    <th class="min-w-150px">일감 제목</th>
 									                                    <th class="min-w-80px">담당자</th> 
 									                                    <th class="min-w-80px m-10">수정(변경)일</th> 
									                                </tr>
									                            </thead>
									                            <tbody class="text-gray-600 fw-semibold">
									                            <c:set var="totalItems" value="${fn:length(workList)}" />
									                                	<c:forEach items="${workList}" var="work" varStatus="status"> 
									                                		<tr class="text-start text-muted fw-bold fs-7 text-uppercase gs-0">
											                               		<c:set var="workNo" value="${work.worksNo}">
											                               		</c:set>
									                                	 		<c:set var="reverseIndex" value="${totalItems - status.index}" />
											                                    <td>${reverseIndex }</td>
											                                    <c:if test="${work.workSttusCode eq 'G01'}">
											                                    	<td><span class="badge badge-primary">진행중</span></td>
											                                    </c:if>
											                                    <c:if test="${work.workSttusCode eq 'G02'}">
											                                    	<td><span  class="badge badge-success">완료</span></td>
											                                    </c:if>
											                                    <c:if test="${work.workSttusCode eq 'G03'}">
											                                    	<td><span  class="badge badge-secondary">대기</span></td>
											                                    </c:if>
											                                    <c:if test="${work.workSttusCode eq 'G04'}">
											                                    	<td><span  class="badge badge-warning">보류</span></td>
											                                    </c:if>
											                                    <c:if test="${work.worksOrd eq 1}">
											                                    	<td class="text-primary">
											                                    	낮음&nbsp;<span class="ki-outline ki-graph-up text-primary"></span>
											                                    	</td>
											                                    </c:if>	
											                                    <c:if test="${work.worksOrd eq 2}">
											                                    	<td class="text-success">
											                                    	보통&nbsp;<span class="ki-outline ki-graph-up text-success"></span>
											                                    	</td>
											                                    </c:if>	
											                                    <c:if test="${work.worksOrd eq 3}">
											                                    	<td class="text-info">
											                                    	높음&nbsp;<span class="ki-outline ki-graph-up text-info"></span>
											                                    	</td>
											                                    </c:if>	
											                                    <c:if test="${work.worksOrd eq 4}">
											                                    	<td class="text-warning">
											                                    	긴급&nbsp;<span class="ki-outline ki-graph-up text-warning"></span>
											                                    	</td>
											                                    </c:if>	
											                                    <c:if test="${work.worksOrd eq 5}">
											                                    	<td class="text-danger">
											                                    	즉시&nbsp;<span class="ki-outline ki-graph-up text-danger"></span>
											                                    	</td>
											                                    </c:if>	
											                                    <td class="work_title text-muted text-hover-primary">${work.worksTitle}</td>
											                                    <td>${work.emplNm2}</td>
											                                    <td>${work.modide}</td>
									                                		</tr>
									                                    </c:forEach> 
									                            </tbody>
									                        </table>
									                        <!--end::Table-->
									                    </div>
									                    <!--end::Card body-->
									                </div>
									                <!--end::Card-->
									            </div>
									            <!--end::Content container-->
									        </div>
									        <!--end::Content-->
									    </div>
									    <!-- 등록폼 -->
									<div id="registrationForm" class="flex-column flex-column-fluid p-4" style="display: none;">
									    <div class="card-title flex-column">
									        <h3 class="fw-bold mb-4">새 일감 등록</h3>
									    </div>
									    <div class="mb-4">
									        <label class="required fs-5 fw-semibold mb-2">일감 제목</label>
									        <input name="worksTitle" type="text" class="form-control" placeholder="일감 제목을 입력하세요" aria-label="Task Title" aria-describedby="basic-addon1"/>
									    </div>
									    <div class="mb-4">
									        <label class="required fs-5 fw-semibold mb-2">일감 설명</label>
									        <div id="worksCon" class="form-control" style="height: 150px;"></div>
									    </div>
									    <div class="container mb-4">
									        <div class="row mb-4">
									            <div class="d-flex justify-content-between w-100">
									                <div class="mb-0" style="width: 48%;">
									                    <label class="required fs-5 fw-semibold mb-2">일감 순서</label>
									                    <select id="worksOrd" class="form-select" data-control="select2" data-placeholder="순서를 선택하세요">
									                        <option></option>
									                        <option value="1">낮음</option>
									                        <option value="2">보통</option>
									                        <option value="3">높음</option>
									                        <option value="4">긴급</option>
									                        <option value="5">즉시</option>
									                    </select>
									                </div>
									                <div class="mb-0" style="width: 48%;">
									                    <label class="required fs-5 fw-semibold mb-2">담당자</label>
									                    <select id="prjctMbrNo2" class="form-select" data-control="select2" data-placeholder="담당자를 선택하세요">
									                        <option></option>
									                        <c:forEach items="${detailList}" var="dl">
									                            <c:forEach items="${dl.pjMemberVO}" var="pvo">
									                                <option value="${pvo.prjctMbrNo}">${pvo.empVO.emplNm}</option>
									                            </c:forEach>
									                        </c:forEach>
									                    </select>
									                </div>
									            </div>
									        </div>
									        <div class="row">
									            <div class="d-flex justify-content-between w-100">
									                <div class="mb-0" style="width: 48%;">
									                    <label for="kt_datepicker_1" class="form-label">일감 시작일</label>
									                    <input class="form-control" placeholder="Pick a date" id="kt_datepicker_1"/>
									                </div>
									                <div class="mb-0" style="width: 48%;">
									                    <label for="kt_datepicker_2" class="form-label">일감 종료일</label>
									                    <input class="form-control" placeholder="Pick a date" id="kt_datepicker_2"/>
									                </div>
									            </div>
									        </div>
									    </div>
									    <div class="mb-4">
									        <label class="required fs-5 fw-semibold mb-2">파일 첨부</label>
									        <input type="file" class="form-control" multiple/>
									    </div>
									    <input type="hidden" name="prjctMbrNo" value="${getVO.prjctMbrNo}" >
									    <!-- 등록 버튼 -->
									    <div class="d-flex justify-content-end">
									        <button id="insert_newwork_btn" type="button" class="btn btn-primary">등록</button>
									    </div>
									</div>
									    <!-- 등록폼 끝 -->
									    <!-- 상세조회 폼 -->
									    <div id="detail_work" class="app-content flex-column-fluid" style="display: none;">
											<div id="kt_app_content_container" class="app-container container-xxl">
												<div class="d-flex flex-column ">
														<div class="card">
															<div class="card-header align-items-center py-5 gap-5">
																<div class="d-flex">
																	<!-- 목록으로 -->
																	<a href="#" class="btn btn-sm btn-icon btn-clear btn-active-light-primary me-3" data-bs-toggle="tooltip" data-bs-placement="top" title="Back">
																		<i class="ki-duotone ki-arrow-left fs-1 m-0">
																			<span class="path1"></span>
																			<span class="path2"></span>
																		</i>
																	</a>
																</div>
																<div class="d-flex align-items-center">
																	<!-- 글수정 -->
																	<a href="#" title="수정" data-bs-toggle="tooltip" data-bs-placement="top" class="btn btn-sm btn-icon btn-light btn-active-light-primary me-2">
																		<i class="ki-duotone ki-message-edit fs-2 m-0">
																			<span class="path1"></span>
																			<span class="path2"></span>
																			<span class="path3"></span>
																		</i>
																	</a>
																	<!-- 글삭제 -->
																	<a href="#" title="삭제" data-bs-toggle="tooltip" data-bs-placement="top" class="btn btn-sm btn-icon btn-light btn-active-light-primary me-2">
																		<i class="ki-duotone ki-trash fs-2 m-0">
																			<span class="path1"></span>
																			<span class="path2"></span>
																			<span class="path3"></span>
																			<span class="path4"></span>
																			<span class="path5"></span>
																		</i>
																	</a>
																	<!-- 프린트 -->
																	<a href="#" title="Print" data-bs-toggle="tooltip" data-bs-placement="top" class="btn btn-sm btn-icon btn-light btn-active-light-primary me-2">
																		<i class="ki-duotone ki-printer fs-2">
																			<span class="path1"></span>
																			<span class="path2"></span>
																			<span class="path3"></span>
																			<span class="path4"></span>
																			<span class="path5"></span>
																		</i>
																	</a>
																</div>
															</div>
															<div class="card-body">
																<!--begin::Title-->
																<div class="d-flex flex-wrap gap-2 justify-content-between mb-8">
																	<div class="d-flex align-items-center flex-wrap gap-2">
																		<!-- 게시글 제목 -->
																		<h2 id="detail_worksTitle" class="fw-semibold me-3 my-1"></h2>
																	</div>
																	<div class="d-flex align-items-center flex-wrap gap-2">
																			
																			<span class="fw-semibold text-muted text-end me-3">작성일시 : </span>
																	</div>
																</div>
																<!--end::Title-->
																<!--begin::Message accordion-->
																<div data-kt-inbox-message="message_wrapper">
																	<!--begin::Message header-->
																	  <div class="d-flex flex-wrap gap-2 flex-stack" data-kt-inbox-message="header">
																	        <!--begin::Author-->
																	        <div class="d-flex align-items-center w-100">
																	            <div class="pe-5 w-100">
																	                <!--begin::Author details-->
																	                <div class="link-container">
																	                    <div class="link-column">
																	                        <div class="link-item">
																	                            <a href="#" class="fw-bold text-gray-900 text-hover-primary">상태:</a>
																	                            <span id="detail_workSttusCode"></span>
																	                        </div>
																	                        <div class="link-item">
																	                            <a href="#" class="fw-bold text-gray-900 text-hover-primary">우선 순위:</a>
																	                            <span id="detail_worksOrd"></span>
																	                        </div>
																	                        <div class="link-item">
																	                            <a href="#" class="fw-bold text-gray-900 text-hover-primary">담당자:</a>
																	                            <span id="detail_prjctMbrNo2"></span>
																	                        </div>
																	                    </div>
																	                    <div class="link-column">
																	                        <div class="link-item">
																	                            <a href="#" class="fw-bold text-gray-900 text-hover-primary">일감 시작일:</a>
																	                            <span id="detail_bgnde"></span>
																	                        </div>
																	                        <div class="link-item">
																	                            <a href="#" class="fw-bold text-gray-900 text-hover-primary">일감 종료일:</a>
																	                            <span id="detail_closOn"></span>
																	                        </div>
																	                        <div class="link-item">
																	                            <a href="#" class="fw-bold text-gray-900 text-hover-primary">진척도:</a>
																	                            <span id="detail_progrsRt"></span>
																	                        </div>
																	                    </div>
																	                </div>
																	                <!--end::Author details-->
																	            </div>
																	        </div>
																	        <!--end::Author-->
																	    </div>
																	
																	<!-- 구분선-->
																	<div class="separator my-6"></div>
																	
																	<!-- 게시글 내용 -->
																	<input type="hidden" id="cn" value="" />
																	<div class="collapse fade show" data-kt-inbox-message="message">
																		<div id="sntncCnArea" class="py-5">작업 이력</div>
																	</div>
																</div>
																
																<!-- 구분선-->
																<div class="separator my-6"></div>
																
															</div>
														</div>
												</div>
											</div>
										</div>
									    <!-- 상세조회 폼끝 -->
									</div>
									<!-- 일감 tab 끝 -->
									<div class="tab-pane fade" id="kt_tab_pane_4" role="tabpanel">
										<p>2</p>
									</div>
									<div class="tab-pane fade" id="kt_tab_pane_5" role="tabpanel">
										<p>3</p>
									</div>
									<div class="tab-pane fade" id="kt_tab_pane_6" role="tabpanel">
										<p>4</p>
									</div>
									<div class="tab-pane fade" id="kt_tab_pane_7" role="tabpanel">
										<p>5</p>
									</div>														
									</div>
									<!-- tab 컨텐츠 끝 -->
									<!--end::Row-->
									<!--end::Card-->
								</div>
								<!--end::Content container-->
							</div>
							<!--end::Content-->
						</div>
						<!--end::Content wrapper-->
<script src="${pageContext.request.contextPath}/resources/js/app/project/chartandcalendar.js"></script>
<script src="${pageContext.request.contextPath}/resources/js/app/project/datatable.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {

    // 플랫피커
    $("#kt_datepicker_1").flatpickr();
    $("#kt_datepicker_2").flatpickr();

    // ck editor
    ClassicEditor
        .create(document.querySelector('#worksCon'), {
            licenseKey: 'eU5USHA5OURMMVdUZE9LeFhNanYyVGZDTlNEZFZndzRVbGZwTThvRkVwdlFPRGZXRHZ3dUhnT056eXRMQmc9PS1NakF5TkRBMk1qST0='
        })
        .then(newEditor => {
            editor = newEditor;
        })
        .catch(error => {
            console.error(error);
        });

    // 등록 버튼 클릭 시 등록 폼 보이기/숨기기
     $('#registerButton').on('click', () => {
        $('#registrationForm').toggle();
        $('#worklist').toggle();
    }); 
     var worksNo = ${workNo};
     console.log("worksNo==>",worksNo);
    
	     var worksTitle = document.querySelector('#detail_worksTitle');
	     var worksCon = document.querySelector('#sntncCnArea');
	     var workSttusCode = document.querySelector('#detail_workSttusCode');
	     var worksOrd = document.querySelector('#detail_worksOrd');
	     var emplNm2 = document.querySelector('#detail_prjctMbrNo2');
	     var bgnde = document.querySelector('#detail_bgnde');
	     var closOn = document.querySelector('#detail_closOn');
	     var progrsRt = document.querySelector('#detail_progrsRt');
     
    // 일감 제목 클릭시 상세조회
    $('.work_title').on('click',()=>{
    	worksTitle.innerHTML = '';
    	worksCon.innerHTML = '';
    	workSttusCode.innerHTML = '';
    	worksOrd.innerHTML = '';
    	emplNm2.innerHTML = '';
    	bgnde.innerHTML = '';
    	closOn.innerHTML = '';
    	progrsRt.innerHTML = '';
    	$.ajax({
    		url:`/projectWork/detailWork/\${worksNo}`,
    		method:'GET',
    		success:function(resp){
    			console.log("resp==>",resp);
    			worksTitle.innerHTML = resp.worksTitle;
    			workSttusCode.innerHTML = resp.workSttusCode;
    			worksOrd.innerHTML = resp.worksOrd;
    			emplNm2.innerHTML = resp.emplNm2;
    			bgnde.innerHTML = resp.bgnde;
    			closOn.innerHTML = resp.closOn;
    			progrsRt.innerHTML = resp.progrsRt+'%';
    			$('#detail_work').toggle();
    	    	$('#worklist').toggle();
    		},
    		errors:function(error){
    			console.log(error);
    		}
    	})
    	
    })
    

    $('[data-bs-toggle="tooltip"]').on('click',()=>{
    	worksTitle.innerHTML = '';
    	worksCon.innerHTML = '';
    	workSttusCode.innerHTML = '';
    	worksOrd.innerHTML = '';
    	emplNm2.innerHTML = '';
    	bgnde.innerHTML = '';
    	closOn.innerHTML = '';
    	progrsRt.innerHTML = '';
    	$('#detail_work').toggle();
    	$('#worklist').toggle();
    })
    
    var $worksTitle = $('input[name=worksTitle]');
    var $worksCon = $('#worksCon');
    var $prjctMbrNo = $('input[name=prjctMbrNo]').val();
    var $prjctMbrNo2 = $('#prjctMbrNo2');
    var $bgnde = $('#kt_datepicker_1');
    var $closOn = $('#kt_datepicker_2');
    var $worksOrd = $('#worksOrd')
    
    $('#insert_newwork_btn').on('click',()=>{
    	let worksTitle = $worksTitle.val();
    	let worksCon = editor.getData();
    	let prjctMbrNo = $prjctMbrNo;
    	let prjctMbrNo2 = $prjctMbrNo2.val();
    	let bgnde = $bgnde.val();
    	let closOn = $closOn.val();
    	let worksOrd = $worksOrd.val();
    	const projectWorkVO = {
    			
    			worksTitle: worksTitle,
    			worksCon: worksCon,
    			prjctMbrNo: prjctMbrNo,
    			prjctMbrNo2: prjctMbrNo2,
    			bgnde: bgnde,
    			closOn: closOn,
    			worksOrd: worksOrd,
    	}
    	
    	$.ajax({
    		url:'/projectWork/insertWork',
    		method:'POST',
    		data: JSON.stringify(projectWorkVO),
    		contentType:"application/json",
    		success:function(resp){
    			$('#registrationForm').toggle();
    	   		 $('#worklist').toggle();
    		}
    	})
    })
});
</script>